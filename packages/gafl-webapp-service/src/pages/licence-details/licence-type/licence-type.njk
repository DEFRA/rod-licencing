{% extends "standard-form.njk" %}
{% from "radios/macro.njk" import govukRadios %}
{% from "warning-text/macro.njk" import govukWarningText %}
{% from "pricing-summary.njk" import pricingSummary, pricingSummaryScript %}

{% set title = 'Which type of licence do you want?' %}

{%
    set errorMap = {
        'licence-type': {
            'any.required': { ref: '#licence-type', text: 'You did not tell us which type of licence you want' }
        }
    }
%}

{% set troutAndCoarse2Rod %}
    <p class="govuk-body-m">This lets you fish non-migratory trout and freshwater fish</p>
    <p class="govuk-body-m">Rods are for the individual licence holder and must be attended at all times</p>
{% endset -%}

{% set troutAndCoarse3Rod %}
    <p class="govuk-body-m">This lets you fish non-migratory trout and freshwater fish</p>
    <p class="govuk-body-m">Rods are for the individual licence holder and must be attended at all times</p>
{% endset -%}

{% set salmonAndSeaTrout %}
    {{ govukWarningText({
      text: "You must submit an annual catch return",
      iconFallbackText: "Warning",
      classes: "govuk-!-margin-top-6"
    }) }}
    <p class="govuk-body-m">You must report you yearly fishing activity in England and Wales if you have a salmon and sea trout licence, even if you did not fish.</p>
    <p class="govuk-body-m">More details can be found at <a target="_blank" href="https://www.gov.uk/catch-return">report a catch return</a>.</p>
{% endset -%}

{% set items = [
        {
            id: 'selector-' + data.licenseTypes.troutAndCoarse2Rod,
            text: "Trout and coarse, up to 2 rods",
            value: data.licenseTypes.troutAndCoarse2Rod,
            checked: payload['licence-type'] === data.licenseTypes.troutAndCoarse2Rod,
            conditional: { html: troutAndCoarse2Rod }
        },
        {
            id: 'selector-' + data.licenseTypes.troutAndCoarse3Rod,
            text: "Trout and coarse, up to 3 rods",
            value: data.licenseTypes.troutAndCoarse3Rod,
            checked: payload['licence-type'] === data.licenseTypes.troutAndCoarse3Rod,
            conditional: { html: troutAndCoarse3Rod }
        },
        {
            id: 'selector-' + data.licenseTypes.salmonAndSeaTrout,
            text: "Salmon and sea trout",
            value: "salmon-and-sea-trout",
            hint: { text: "Includes trout and coarse, up to 3 rods" },
            checked: payload['licence-type'] === data.licenseTypes.salmonAndSeaTrout,
            conditional: { html: salmonAndSeaTrout }
        }
    ]
%}

{% block pageContent %}
    {{ govukRadios({
        idPrefix: "licence-type",
        name: "licence-type",
        items: items,
        errorMessage: { text: 'Tell us which type of fishing licence you want' } if error
    }) }}
{% endblock %}

{% block pricingSummary %}
    {{ pricingSummary(data.pricing.byType, {
        '12M': { desc: '12 month' },
        '8D': { desc: '8 days' },
        '1D': { desc: '1 day' },
        'no-short': 'Shorter lengths are not available for this licence type'
    }) }}
{% endblock %}

{% block bodyEnd %}
    <script nonce={{nonce}} src="/public/javascript/all-min.js"></script>
    <script nonce={{nonce}}>window.GOVUKFrontend.initAll()</script>
    {{ pricingSummaryScript(data.pricing.byType, nonce) }}
{% endblock %}
